(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{444:function(t,s,a){"use strict";a.r(s);var e=a(1),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"一、数据收集-exporter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、数据收集-exporter"}},[t._v("#")]),t._v(" 一、数据收集 (Exporter)")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("exporter")]),t._v(" 是 prometheus 一类数据采集组件的总称, 他负责从目标处收集数据, 并转换为 prometheus 支持的格式\n"),s("code",[t._v("node_exporter")]),t._v(" 是一种比较主流的服务器性能指标采集工具, 默认端口为 9100\n"),s("code",[t._v("mysql_exporter")]),t._v(" 用于收集 MySQL 数据库的各项指标, 默认端口为 9104")])]),t._v(" "),s("h3",{attrs:{id:"_1-下载-exporter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载-exporter"}},[t._v("#")]),t._v(" 1. 下载 Exporter")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/momoyan/p/11520755.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("常用的 Exporter 下载"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("mark",[t._v("nohup")]),t._v(" 静默启动, "),s("mark",[t._v("2>&1")]),t._v(" 不显示 "),s("mark",[t._v("nohup")]),t._v(" 时的报错信息, & 允许后台运行")]),t._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /usr/local/node_exporter\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" ./node_exporter  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/dev/null "),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h2",{attrs:{id:"二、保存数据-prometheus-普罗米修斯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、保存数据-prometheus-普罗米修斯"}},[t._v("#")]),t._v(" 二、保存数据 (Prometheus 普罗米修斯)")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("Prometheus")]),t._v(": 是一款开源的监控报警系统与时序数据库, 默认端口为 9090\n对时间精度要求较高, 如果服务器时间与现实时间不同步, 可能无法收集到准确的数据.")])]),t._v(" "),s("p",[t._v("时间校准命令:")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("ntpdate ntp.aliyun.com\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("如果提示没有 "),s("code",[t._v("没有 ntpdate 命令")]),t._v(", 则使用以下命令进行安装")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y ntp\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("与 Exporter 或 sql 关联, 在 "),s("code",[t._v("/usr/local/prometheus/prometheus.yml")]),t._v(" 中修改")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# node_exporter 关联")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("job_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'agent'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("static_configs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targets")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9100'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[s("code",[t._v("localhost")]),t._v(" 可以修改为实际需要关联的服务器")])]),t._v(" "),s("h2",{attrs:{id:"三、展示数据-grafana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、展示数据-grafana"}},[t._v("#")]),t._v(" 三、展示数据 (Grafana)")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("Grafana")]),t._v(" 是一个开源的, 可视化监控工具;\n可以配合 "),s("code",[t._v("Prometheus")]),t._v(" 与 "),s("code",[t._v("node_exporter")]),t._v(" 配合监控服务器")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.aliyundrive.com/s/s9TB8WonvR4",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grafana 模板下载"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"_1-登录-grafana-默认账号密码为-admin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录-grafana-默认账号密码为-admin"}},[t._v("#")]),t._v(" 1.登录 Grafana , 默认账号密码为 "),s("code",[t._v("admin")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://pupper.com.cn/img/20220820165401.png",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://pupper.com.cn/img/20220820165710.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"_2-关联-prometheus"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-关联-prometheus"}},[t._v("#")]),t._v(" 2.关联 Prometheus")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://pupper.com.cn/img/20220820174131",alt:"20220820174131"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://pupper.com.cn/img/20220820174224",alt:"20220820174224"}})]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("URL 尽量写全路径, 防止关联失败")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://pupper.com.cn/img/20220820174408",alt:"20220820174408"}})]),t._v(" "),s("h3",{attrs:{id:"_3-添加监控模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加监控模板"}},[t._v("#")]),t._v(" 3. 添加监控模板")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://pupper.com.cn/img/20220820175007",alt:"20220820175007"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://pupper.com.cn/img/20220820175542",alt:"20220820175542"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);