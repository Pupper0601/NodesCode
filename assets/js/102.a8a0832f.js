(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{442:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"一、-安装-locust"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、-安装-locust"}},[s._v("#")]),s._v(" 一、 安装 locust")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("pip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" locust\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"验证是否安装成功"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证是否安装成功"}},[s._v("#")]),s._v(" 验证是否安装成功")]),s._v(" "),t("div",{staticClass:"language-powershell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[s._v("import locust\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"二、-关键字说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、-关键字说明"}},[s._v("#")]),s._v(" 二、 关键字说明")]),s._v(" "),t("h3",{attrs:{id:"_1-wait-time-每个用户执行后的等待时间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-wait-time-每个用户执行后的等待时间"}},[s._v("#")]),s._v(" 1. wait_time (每个用户执行后的等待时间）")]),s._v(" "),t("p",[s._v("如果没有指定 wait_time ，则下个任务将立即执行")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 随机等待 1~5 秒")]),s._v("\nwait_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" between"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_2-weight-和-fixed-count-属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-weight-和-fixed-count-属性"}},[s._v("#")]),s._v(" 2. weight 和 fixed_count 属性")]),s._v(" "),t("p",[s._v("多个用户类时，使用 "),t("code",[s._v("weight")]),s._v(" 来确认 产生的用户比例")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WebUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    weight "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MobileUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    weight "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("fixed_count")]),s._v(" 来确认用户类产生的个数，与总数无关")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AdminUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    wait_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" constant"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    fixed_count "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("restart_app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WebUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_3-on-start-和-on-stop-方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-on-start-和-on-stop-方法"}},[s._v("#")]),s._v(" 3. on_start 和 on_stop 方法")]),s._v(" "),t("p",[t("strong",[s._v("on_start")]),s._v(" : 开始运行前调用（相当于 前置）")]),s._v(" "),t("p",[t("strong",[s._v("on_stop")]),s._v(" ：结束运行时调用（相当于 后置）")]),s._v(" "),t("h3",{attrs:{id:"_4-task-装饰器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-task-装饰器"}},[s._v("#")]),s._v(" 4. @task 装饰器")]),s._v(" "),t("ul",[t("li",[s._v("为用户添加任务的最简单方法")]),s._v(" "),t("li",[s._v("接受一个可选的权重参数，可用于指定任务的执行率")])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" locust "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" task"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" between\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MyUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    wait_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" between"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("task1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("task2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"_5-tasks-任务属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-tasks-任务属性"}},[s._v("#")]),s._v(" 5. tasks 任务属性")]),s._v(" "),t("p",[t("code",[s._v("tasks")]),s._v(" 可以是 列表 或 字典")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("列表： 元素为普通函数，执行时随机选择")]),s._v(" "),t("ul",[t("li",[s._v("例如："),t("code",[s._v("tasks = [my_task, my_task1, my_task2]")])])])]),s._v(" "),t("li",[t("p",[s._v("字典： 可调用的对象作为键， 整数作为值，值为执行比率，执行时随机选择")]),s._v(" "),t("ul",[t("li",[s._v("例如： "),t("code",[s._v("{my_task: 3, another_task: 1}")])]),s._v(" "),t("li",[s._v("my_task 被执行的可能性是another_task的 3 倍。")])])])]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" locust "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" constant\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("my_task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MyUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    tasks "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("my_task"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    wait_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" constant"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_6-tag-装饰器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-tag-装饰器"}},[s._v("#")]),s._v(" 6. @tag 装饰器")]),s._v(" "),t("p",[s._v("使用 "),t("a",{attrs:{href:"http://docs.locust.io/en/stable/api.html#locust.tag",target:"_blank",rel:"noopener noreferrer"}},[s._v("@tag"),t("OutboundLink")],1),s._v(" 装饰器标记任务")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" locust "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" constant"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" task"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" tag\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MyUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    wait_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" constant"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@tag")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tag1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("task1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@tag")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tag1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tag2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("task2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@tag")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tag3'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("task3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("task4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pass")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("--tags :  需要执行的任务")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("--tags tag2 tag3")])]),s._v(" "),t("li",[s._v("执行  标记为 tag2 和 tag3 的认为")])])]),s._v(" "),t("li",[t("p",[s._v("--exclude-tags ： 除这些之外的任务")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("--exclude-tags tag3")])]),s._v(" "),t("li",[s._v("执行 标记 tag3 之外的所有任务")])])])]),s._v(" "),t("h3",{attrs:{id:"_7-test-start-和-test-stop"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-test-start-和-test-stop"}},[s._v("#")]),s._v(" 7. test_start 和 test_stop")]),s._v(" "),t("p",[s._v("用于在开始 和 结束 测试时执行。")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" locust "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" events\n\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@events"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("test_start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("add_listener")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("on_test_start")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("kwargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A new test is starting"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@events"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("test_stop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("add_listener")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("on_test_stop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("kwargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A new test is ending"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_8-httpuser"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-httpuser"}},[s._v("#")]),s._v(" 8. HttpUser")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来模拟用户")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("self.client")]),s._v(" ：接口请求")])])]),s._v(" "),t("h2",{attrs:{id:"三、-压力测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、-压力测试"}},[s._v("#")]),s._v(" 三、 压力测试")]),s._v(" "),t("h3",{attrs:{id:"_1-文件编写"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-文件编写"}},[s._v("#")]),s._v(" 1. 文件编写")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# locustfile.py")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" random\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" locust "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" HttpUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" task"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" between\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义 class 来模拟发送 Http 请求的用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("QuickstartUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HttpUser"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  \t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求间隔 5~9s")]),s._v("\n    wait_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" between"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过装饰器将函数定义为用户模拟执行的任务")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("index_page")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/world"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 任务权重，模拟任务执行的比例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送 ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@task")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("view_item")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        item_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" random"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("randint"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送 get 请求")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string-interpolation"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"/item?id=')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("item_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/item"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 模拟的每个用户执行任务前先执行的操作")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("on_start")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送 post 请求")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("post"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/login"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bar"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"_2-用测执行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-用测执行"}},[s._v("#")]),s._v(" 2. 用测执行")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[s._v("locust "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f locust_files"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("locustfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("注：如果文件名字是locustfile.py，可以省略指定名称，因为执行locust命令时，源码中默认执行的文件名是locustfile.py。")]),s._v(" "),t("h3",{attrs:{id:"_3、打开web-ui-压测管理界面"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、打开web-ui-压测管理界面"}},[s._v("#")]),s._v(" 3、打开web UI 压测管理界面")]),s._v(" "),t("p",[s._v("在浏览器中输入 http://127.0.0.1:8089/ ，打开管理界面如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pupper.com.cn/img/20220725162521",alt:"20220725162521"}})]),s._v(" "),t("p",[s._v("注意：如果服务部署在服务器，可以通过IP:8089访问")]),s._v(" "),t("p",[s._v("输入模拟的用户数，点击开始start swarming 就可以开始压测啦。")]),s._v(" "),t("p",[s._v("参数说明：")]),s._v(" "),t("ul",[t("li",[s._v("Number of total users to simulate：模拟的用户数量")]),s._v(" "),t("li",[s._v("Hatch rate：每秒中产生的发送的用户数")]),s._v(" "),t("li",[s._v("Host：指定向那台服务器发起压测任务")])]),s._v(" "),t("p",[s._v("注：Hatch rate 是客户端向服务器每秒发送多少请求，但是服务器端不一定能处理过来，如果处理不过来，在服务端服请求就会排队等待处理，通过观察服务器CPU的负载Load AVG，可以查看排队情况。")]),s._v(" "),t("h3",{attrs:{id:"_4、查看压测监控指标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、查看压测监控指标"}},[s._v("#")]),s._v(" 4、查看压测监控指标")]),s._v(" "),t("p",[s._v("开始压测后，在监控详情页，可以实时查看服务器请求的成功失败情况，以及每个请求的响应时间，以及")]),s._v(" "),t("p",[s._v("最重要的一个参数：RPS 服务器每秒处理请求的数量")]),s._v(" "),t("p",[t("strong",[s._v("Statistics 压测概要")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pupper.com.cn/img/20220725162603",alt:"20220725162603"}})]),s._v(" "),t("p",[t("strong",[s._v("监控参数说明：")])]),s._v(" "),t("ul",[t("li",[s._v("Type： 请求的类型，例如GET/POST")]),s._v(" "),t("li",[s._v("Name：请求的路径")]),s._v(" "),t("li",[s._v("request：截止当前为止，客户端已发送请求的数量")]),s._v(" "),t("li",[s._v("fails：截止当前为止，客户端已发送请求失败的数量")]),s._v(" "),t("li",[s._v("Median：中间值，单位毫秒，一半的服务器响应时间低于该值，而另一半高于该值")]),s._v(" "),t("li",[s._v("90%ile：将请求响应时间从小到大排序，第90%请求的单个耗时，意味着90%的请求小于当前值")]),s._v(" "),t("li",[s._v("Average：平均值，单位毫秒，所有请求的平均响应时间")]),s._v(" "),t("li",[s._v("Min：请求的最小服务器响应时间，单位毫秒")]),s._v(" "),t("li",[s._v("Max：请求的最大服务器响应时间，单位毫秒")]),s._v(" "),t("li",[s._v("Content Size：单个请求的大小，单位字节")]),s._v(" "),t("li",[s._v("Current RPS：每个任务当前的RPS值，即服务器端当前时刻每秒处理当前任务的数量")]),s._v(" "),t("li",[s._v("Current Failures/s：每秒请求失败数")])]),s._v(" "),t("p",[s._v("说明如下：")]),s._v(" "),t("ul",[t("li",[s._v("Total Requests per second：每秒请求发送数曲线")]),s._v(" "),t("li",[s._v("Response Times：响应时间曲线")]),s._v(" "),t("li",[s._v("Number of Users：模拟的用户生成曲线")])]),s._v(" "),t("h2",{attrs:{id:"四、-运行模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、-运行模式"}},[s._v("#")]),s._v(" 四、 运行模式")]),s._v(" "),t("h3",{attrs:{id:"_1-web-ui-模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-web-ui-模式"}},[s._v("#")]),s._v(" 1. web ui 模式")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("locust -f stress_test.py --web-host "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".44.31 --web-port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("--web-host：指定 web UI IP，默认 localhost")])]),s._v(" "),t("li",[t("p",[s._v("--web-port：指定 web UI 端口，默认 8089")])])]),s._v(" "),t("h3",{attrs:{id:"_2-no-web-模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-no-web-模式"}},[s._v("#")]),s._v(" 2. no web 模式")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("locust -f stress_test.py --no-web -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" -r "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" -t "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("--no-web：指定无 web UI模式")])]),s._v(" "),t("li",[t("p",[s._v("-c：起多少 locust 用户（等同于起多少 tcp 连接）")])]),s._v(" "),t("li",[t("p",[s._v("-r：多少时间内，把上述 -c 设置的虚拟用户全部启动")])]),s._v(" "),t("li",[t("p",[s._v("-t：脚本运行多少时间，单位s")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pupper.com.cn/img/20220725162639",alt:"20220725162639"}})]),s._v(" "),t("h3",{attrs:{id:"_3-分布式进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-分布式进程"}},[s._v("#")]),s._v(" 3. 分布式进程")]),s._v(" "),t("h4",{attrs:{id:"单台多进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#单台多进程"}},[s._v("#")]),s._v(" 单台多进程：")]),s._v(" "),t("p",[s._v("先启一个 master")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("locust -f /home/script/stress_test.py --web-host "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".62.223 --master\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("再启 8 个 slave")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("locust -f /home/script/stress_test.py --slave\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("slave 节点启动后，在 locust 监控中能看到")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pupper.com.cn/img/20220725162704",alt:"20220725162704"}})]),s._v(" "),t("h4",{attrs:{id:"多台多进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多台多进程"}},[s._v("#")]),s._v(" 多台多进程：")]),s._v(" "),t("p",[s._v("多台机器搭建 Locust 分布式 和 单台搭建多进程差不多。"),t("strong",[s._v("只有一个区别，如果 slave 和 master 不在一台机器上， slave 需要指定 --master-host 参数：")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("locust -f /home/script/stress_test.py --slave --master-host "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".62.223\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://pupper.com.cn/img/20220725162733",alt:"20220725162733"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);